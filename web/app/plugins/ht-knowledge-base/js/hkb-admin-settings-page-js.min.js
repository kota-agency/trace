jQuery(document).ready(function($){"use strict";$("input#tabindex").val();var errorMessage="",settingsPageObjects=window.settingsPageObjects;function setActiveTab(tabName){$("#hkb-settings-tabs a").removeClass("active"),$("#hkb-settings-tabs a#"+tabName+"-link").addClass("active"),$(".hkb-settings-section").each(function(index,item){var currentItem=$(item);tabName==item.id?(currentItem.show(),currentItem.addClass("active")):(currentItem.removeClass("active"),currentItem.hide())}),$("input#activetab").val(tabName)}$("#hkb-settings-tabs a").click(function(e){e.preventDefault(),setActiveTab($(this).attr("href").substring(1))});var tabName,availableTabs,tabs,tabNames,initialActiveTab=$("#activetab").val(),hashTab=window.location.hash.replace("#","");function updateSubCatOptionsDisplay(){return $(".ht-knowledge-base-settings-display-sub-cats__input").attr("checked")?($(".ht-knowledge-base-settings-sub-cat-depth__input").parents("tr").show(400),void $(".ht-knowledge-base-settings-display-sub-cat-articles__input").parents("tr").show(400)):($(".ht-knowledge-base-settings-sub-cat-depth__input").parents("tr").hide(400),void $(".ht-knowledge-base-settings-display-sub-cat-articles__input").parents("tr").hide(400))}function updateFeedbackOptions(){return $(".ht-knowledge-base-settings-enable-article-feedback__input").attr("checked")?($(".ht-knowledge-base-settings-enable-anon-article-feedback__input").parents("tr").show(400),$(".ht-knowledge-base-settings-enable-upvote-article-feedback__input").parents("tr").show(400),void $(".ht-knowledge-base-settings-enable-downvote-article-feedback__input").parents("tr").show(400)):($(".ht-knowledge-base-settings-enable-anon-article-feedback__input").parents("tr").hide(400),$(".ht-knowledge-base-settings-enable-upvote-article-feedback__input").parents("tr").hide(400),void $(".ht-knowledge-base-settings-enable-downvote-article-feedback__input").parents("tr").hide(400))}function updateSortOptions(){return"custom"!=$(".ht-knowledge-base-settings-sortby__input").val()?void $(".ht-knowledge-base-settings-sort-order__input").parents("tr").show(400):void $(".ht-knowledge-base-settings-sort-order__input").parents("tr").hide(400)}function validateSlugs(){var articleSlugVal=$(".ht-knowledge-base-settings-kb-article-slug__input").val().replace(/\/+$/,""),categorySlugVal=$(".ht-knowledge-base-settings-kb-category-slug__input").val().replace(/\/+$/,""),tagSlugVal=$(".ht-knowledge-base-settings-kb-tag-slug__input").val().replace(/\/+$/,""),slugsValid=!0;return(slugsValid=(slugsValid=(slugsValid=(slugsValid=(slugsValid=(slugsValid=(slugsValid=(slugsValid=slugsValid&&function(articleSlugVal,categorySlugVal,tagSlugVal){var slugsValid=!0;return!!(slugsValid=(slugsValid=(slugsValid=slugsValid&&articleSlugVal!=categorySlugVal)&&articleSlugVal!=tagSlugVal)&&categorySlugVal!=tagSlugVal)||(errorMessage=settingsPageObjects.conflictedSlugError,!1)}(articleSlugVal,categorySlugVal,tagSlugVal))&&function(articleSlugVal,categorySlugVal,tagSlugVal){var slugsValid=!0,articleBase=stringBase(articleSlugVal),categoryBase=stringBase(categorySlugVal),tagBase=stringBase(tagSlugVal);return!!(slugsValid=(slugsValid=(slugsValid=(slugsValid=(slugsValid=(slugsValid=slugsValid&&articleSlugVal!=categoryBase)&&articleSlugVal!=tagBase)&&categorySlugVal!=articleBase)&&categorySlugVal!=tagBase)&&tagSlugVal!=articleBase)&&tagSlugVal!=categoryBase)||(errorMessage=settingsPageObjects.heirachicalSlugError,!1)}(articleSlugVal,categorySlugVal,tagSlugVal))&&slugNotReserved(articleSlugVal))&&slugNotReserved(categorySlugVal))&&slugNotReserved(tagSlugVal))&&slugNotInUse(articleSlugVal))&&slugNotInUse(categorySlugVal))&&slugNotInUse(tagSlugVal))?$("#hkb-settings-tabs > form").find(":input[type=submit]").prop("disabled",!1):($("#hkb-settings-tabs > form").find(":input[type=submit]").prop("disabled",!0),function(msg){msg||(msg="");$(".hkb-settings-infoarea").html(msg)}(errorMessage)),slugsValid}function stringBase(str){var slashIndex=str.indexOf("/");return slashIndex<0?str:str.substring(0,slashIndex)}function slugNotReserved(slug){return!($.inArray(slug,settingsPageObjects.reservedTerms)>=0)||(errorMessage=settingsPageObjects.reservedTermError,!1)}function slugNotInUse(slug){return!($.inArray(slug,settingsPageObjects.existingPostNames)>=0)||(errorMessage=settingsPageObjects.slugInUseError,!1)}function validateSlugInput(slugInput){$(slugInput).blur(function(){$(this).val($(this).val().toLowerCase().replace(/ /g,"-").replace(/[^\w-\/]+/g,"")),validateSlugs()||(alert(errorMessage),$(this).focus(),$(this).select())})}""!==hashTab&&(initialActiveTab=hashTab),""===initialActiveTab||(tabName=initialActiveTab,tabs=$("#hkb-settings-tabs a"),tabNames=[],$.each(tabs,function(key,tab){tabNames.push($(tab).attr("id"))}),availableTabs=tabNames,$.inArray(tabName+"-link",availableTabs)<0)?setActiveTab("general-section"):setActiveTab(initialActiveTab),$(".ht-knowledge-base-settings-display-sub-cats__input").change(function(){updateSubCatOptionsDisplay()}),updateSubCatOptionsDisplay(),$(".ht-knowledge-base-settings-display-live-search__input").change(function(){}),$(".ht-knowledge-base-settings-enable-article-feedback__input").change(function(){updateFeedbackOptions()}),updateFeedbackOptions(),$(".ht-knowledge-base-settings-sortby__input").change(function(){updateSortOptions()}),updateSortOptions(),$(".ht-validate-number-input").blur(function(){var currentInput=$(this),currentInputVal=currentInput.val(),lowerLimit=currentInput.data("lower-limit"),upperLimit=currentInput.data("upper-limit");Math.floor(currentInputVal)==currentInputVal&&$.isNumeric(currentInputVal)&&currentInputVal<=upperLimit&&currentInputVal>=lowerLimit||(alert(currentInput.data("validation-requirements")),currentInput.focus())}),validateSlugInput(".ht-knowledge-base-settings-kb-article-slug__input"),validateSlugInput(".ht-knowledge-base-settings-kb-tag-slug__input "),validateSlugInput(".ht-knowledge-base-settings-kb-category-slug__input"),$("#hkb-settings-tabs > form").submit(function(e){validateSlugs()||e.preventDefault()});new function(){var id,change=function(e){!function(){for(var menuElements=document.querySelectorAll(".hkb-btngroup__btn"),i=0;i<menuElements.length;i++){menuElements[i].classList.remove("active"),menuElements[i].parentElement.checked=!1;var id=menuElements[i].getAttribute("data-tab");document.getElementById(id).classList.remove("active")}}(),e.target.classList.add("active");var id=e.currentTarget.getAttribute("data-tab");document.getElementById(id).classList.add("active"),e.target.parentElement.checked=!0};!function(){for(var menuElements=document.querySelectorAll(".hkb-btngroup__btn"),i=0;i<menuElements.length;i++)menuElements[i].addEventListener("click",change,!1)}(),id=document.querySelectorAll("input.hkb-btngroup__radio:checked")[0].value,document.getElementById(id).classList.add("active")};$(function(){$(".hkb-colorpicker").wpColorPicker()}),$(document).on("click",".hkb-bgimageselect__btn",function(e){e.preventDefault();var button=$(this),mediaFrame=wp.media.frames.file_frame=wp.media({title:"Select or upload an image",library:{type:"image"},button:{text:"Select"},multiple:!1});mediaFrame.on("select",function(){var attachment=mediaFrame.state().get("selection").first().toJSON();if("image"==attachment.type){button.siblings(".hkb-bgimageselect__id").val(attachment.id).change();var previewUrl=attachment.sizes.hasOwnProperty("thumbnail")?attachment.sizes.thumbnail.url:attachment.sizes.full.url;button.siblings(".hkb-bgimageselect__preview").attr("src",previewUrl).change()}}),mediaFrame.open()}),$(document).on("click",".hkb-bgimageselect__remove",function(e){e.preventDefault();var button=$(this);button.siblings(".hkb-bgimageselect__id").val(0).change();var preview=button.siblings(".hkb-bgimageselect__preview"),fallback=preview.attr("data-fallback");preview.attr("src",fallback).change()})});